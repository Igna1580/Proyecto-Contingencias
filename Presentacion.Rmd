---
title: "Seguro de cuidados de largo plazo"
subtitle: "CA-309 Contingencias de Vida II"
author:
  - José Ignacio Rojas Zárate, C16911
  - María Carolina Navarro, C05513
  - Montserrat Beirute Abarca, C10997
  - Valeria Vásquez Venegas, C18373
date: "`r format(Sys.Date(), '%d de %B de %Y', locale = 'es_ES')`"
output:
  rmdformats::readthedown:
    code_folding: hide
  html_document:
    toc: TRUE
bibliography: bibliografia_contingencias.bib
csl: apa.csl  
editor_options: 
  chunk_output_type: console

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introducción

El presente trabajo tiene como objetivo presentar el diseño de un producto de cuidados de largo plazo para la población costarricense. El producto propuesto se llama **Longevidad Asegurada** y realiza pagos anuales de forma vitalicia, dependiendo del estado de salud de la persona, siempre y cuando esta realice pagos de primas anuales hasta los 65 años. 

La propuesta actual se centra en ofrecer a los clientes un producto especializado que les brinde mayor seguridad de contar con ingresos anuales en el futuro, proporcionándoles los recursos necesarios para hacer frente a gastos médicos, cirugías y cuidados en la etapa final de la vida, sin depender de apoyo financiero externo.

Debido a que este producto no se encuentra actualmente en el país, se utilizan como base para los cálculos los datos experimentales de probabilidad en el trabajo: "A multiple state model for pricing and reserving private long term care insurance contracts in Australia" [@leung2006multiple].

## Supuestos

Para poder crear un producto que sea rentable, se utilizaron herramientas de matemática actuarial y fue necesario tomar una serie de supuestos que se presentan a continuación: 

1. **Inflación:** Se considera un valor fijo de inflación de $2.88\%$. Este es un promedio de la inflación en Costa Rica en los últimos 10 años según datos de [@inflacion], alimentados por la base de datos del Fondo Monetario Internacional, Banco Mundial e indicador del IPC de la OCDE.  

2. **Tasa de descuento:** Se descargó la base de datos de la Curva de Rendimeinto Soberana del Banco Central a tres meses y se decidió considerar un promedio de las tasas de los últimos seis meses, específicamente desde 03/05/2023 al 07/11/2023 [@descuento]. Por lo tanto, se consdiera una tasa de descuento del $5.8\%$ para realizar los cálculos respectivos. 

3. **Gastos:** Se consideran unos gastos inciales de 20\% de la primera prima y 5\% de las subsiguientes primas. 

4. **Población:** Se utilizaron estadísticas demográficas del 2023 basadas en proyecciones a partir del año 2018 como fuente de datos de la población costarricense [@poblacion]. Estas estadísticas proporcionan información sobre la cantidad de personas costarricenses vivas, desglosadas por género, en edades que varían desde 0 hasta 100 años. El producto que se presenta en este informe está dirigido específicamente a personas con edades comprendidas entre 30 y 65 años, ya que se considera que es menos atractivo para un público más joven. A partir de los 45 años, se espera que el interés en este seguro se distribuya de manera más uniforme. A continuación, se presenta dos cuadros con la información de la población considerada en el diseño de este producto para hombres y mujeres. 

```{r, echo=FALSE, results='hide', message=FALSE}

suppressWarnings({
  library(tidyverse)
  library(janitor)
  library(dplyr)
  library(ggplot2)
  library(plotly)
  library(knitr)
  library(readxl)
  library("papaja")
  library(kableExtra)
})

Hombres_2023_demografia <- read_excel("repoblacev2011-2050-05_2.xlsx", sheet = "Cuadro 5 ", range = "G1017:G1177")
Mujeres_2023_demografia <- read_excel("repoblacev2011-2050-05_2.xlsx", sheet = "Cuadro 5 ", range = "G1857:G2017")

colnames(Hombres_2023_demografia) <- c("poblacion_Hombres")
colnames(Mujeres_2023_demografia) <- c("poblacion_Mujeres")
filtro <- c()
for (i in 0:19){
  filtro <- c(filtro, (4+i*8):(8+i*8))
}

Hombres_2023_demografia <- Hombres_2023_demografia[filtro,1]
Mujeres_2023_demografia <- Mujeres_2023_demografia[filtro,1]

Prob_Trans_Hombres <- read.csv("ProbTransHombres.csv", sep = ";")
Prob_Trans_Mujeres <- read.csv("ProbTransMujeres.csv", sep = ";")
edades <- 31:65

porcentajes <- c(0.05, 0.05, 0.8, 0.08, 0.10, 0.10, 0.15, 0.15, 0.20, 0.20, 0.25, 0.25, 0.30, 0.30, 0.35,
                 rep(0.6, 20))  # Luego, 20 porcentajes uniformes de 0.6
# Caso hombres 

# Crear un dataframe para las edades
edades_df <- data.frame(Edad = edades-1)

edades_seleccionadas_hombres <- Hombres_2023_demografia[edades,] 

# Unir el dataframe de edades con el dataframe de hombres
edades_seleccionadas_hombres <- cbind(edades_df, edades_seleccionadas_hombres)


# Luego puedes agregar este vector de porcentajes al dataframe edades_seleccionadas_hombres
edades_seleccionadas_hombres$Porcentajes_Diferentes <- porcentajes

# Calcular la población por edad (multiplicar la cantidad de hombres por el porcentaje)
edades_seleccionadas_hombres$Poblacion_por_Edad <- edades_seleccionadas_hombres$poblacion_Hombres* edades_seleccionadas_hombres$Porcentajes_Diferentes

# Caso Mujeres 
edades_seleccionadas_mujeres <- Mujeres_2023_demografia[edades,] 
edades_seleccionadas_mujeres <- cbind(edades_df, edades_seleccionadas_mujeres)
edades_seleccionadas_mujeres$Porcentajes_Diferentes <- porcentajes
edades_seleccionadas_mujeres$Poblacion_por_Edad <- edades_seleccionadas_mujeres$poblacion_Mujeres * edades_seleccionadas_mujeres$Porcentajes_Diferentes

edades_seleccionadas_hombres <- edades_seleccionadas_hombres %>%
  rename(
    "Número de hombres" = poblacion_Hombres,
    "Porcentaje" = Porcentajes_Diferentes,
    "Número de hombres considerados"= Poblacion_por_Edad
  )

edades_seleccionadas_mujeres <- edades_seleccionadas_mujeres %>%
  rename(
    "Número de mujeres" = poblacion_Mujeres,
    "Porcentaje" = Porcentajes_Diferentes,
    "Número de mujeres consideradas"= Poblacion_por_Edad
  )

tabla_html <- knitr::kable(edades_seleccionadas_mujeres, format = "html")
tabla_html_hombres <- knitr::kable(edades_seleccionadas_hombres, format = "html")

```

```{r, results='asis',echo=FALSE}
cat('<button onclick="var x = document.getElementById(', "'tabla_hombres'", '); if (x.style.display === ', "'none'", ') { x.style.display = ', "'block'", '; } else { x.style.display = ', "'none'", '; }"> Mostrar u ocultar cuadro hombres</button>')

cat('<div id="tabla_hombres" style="display: none;">')
cat(tabla_html_hombres)
cat('</div>')

cat('<button onclick="var x = document.getElementById(', "'tabla_mujeres'", '); if (x.style.display === ', "'none'", ') { x.style.display = ', "'block'", '; } else { x.style.display = ', "'none'", '; }"> Mostrar u ocultar cuadro mujeres</button>')

cat('<div id="tabla_mujeres" style="display: none;">')
cat(tabla_html)
cat('</div>')
```



##  Bibliografía

\bibliography{bibliografia_contingencias.bib}





This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
